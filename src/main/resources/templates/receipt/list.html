<!DOCTYPE html>
<html
  lang="pt-br"
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layout}"
>
  <head>
    <title>Recibos Gerados</title>
    <style>
      /* Estilos para a visualização na tela */
      .printable-page {
        background: white;
        border: 1px solid #ddd;
        margin-bottom: 2rem;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
      }

      .receipt-copy {
        padding: 2rem;
      }

      .top-copy {
        border-bottom: 2px dashed #ccc;
      }

      .receipt-header h3 {
        font-weight: 600;
        letter-spacing: 1px;
        text-transform: uppercase;
      }

      .receipt-body p {
        font-size: 1.2rem;
        line-height: 1.8;
      }

      .signature-line {
        margin-top: 2rem;
        text-align: center;
      }

      .copy-indicator {
        font-size: 0.8rem;
        color: #888;
        font-weight: bold;
        text-align: right;
      }

      .tenant-contact-info {
        font-size: 0.9rem;
        color: #555;
        text-align: right; /* ALTERADO DE 'center' PARA 'right' */
        margin-top: 1.5rem;
      }

      .no-print {
        display: none;
      }

      /* Responsividade para dispositivos móveis */
      @media (max-width: 768px) {
        .page-header .d-flex {
          flex-direction: column;
          gap: 1rem;
        }
        .page-header > div > div {
          width: 100%;
        }
        .page-header .btn {
          width: 100%;
          margin-top: 0.5rem;
        }
        .receipt-copy {
          padding: 1rem;
        }
        .receipt-body p {
          font-size: 1rem;
          line-height: 1.6;
        }
        .receipt-header {
          flex-direction: column !important;
          align-items: flex-start !important;
        }
        .copy-indicator {
          margin-top: 0.5rem;
        }
      }

      /* Estilos específicos para impressão */
      @media print {
        body,
        html {
          margin: 0;
          padding: 0;
          width: 100%;
          height: 100%;
        }
        body * {
          visibility: hidden;
        }
        .no-print {
          display: none;
        }
        #print-area,
        #print-area * {
          visibility: visible;
        }
        #print-area {
          position: absolute;
          left: 0;
          top: 0;
          width: 100%;
        }
        .printable-page {
          width: 210mm;
          height: 297mm;
          box-shadow: none;
          border: none;
          margin: 0;
          padding: 0;
          page-break-after: always;
          display: flex;
          flex-direction: column;
        }
        .receipt-copy {
          height: 148.5mm;
          box-sizing: border-box;
          padding: 1.5cm;
          display: flex;
          flex-direction: column;
          justify-content: space-between;
          border-bottom: 2px dashed #000;
        }
        .top-copy {
          border-top: 2px dashed #000;
          border-bottom: 2px dashed #000;
        }
        .receipt-body p {
          font-size: 14pt;
          line-height: 1.6;
        }
        .signature-line {
          margin-top: 1.5cm;
        }

        .tenant-contact-info {
          font-size: 10pt;
          color: #333;
          margin-top: 1cm;
          text-align: right; /* ADICIONADO ALINHAMENTO PARA IMPRESSÃO */
        }
      }
    </style>
  </head>

  <body>
    <section layout:fragment="content">
      <div class="page-header no-print">
        <div
          class="d-flex justify-content-between align-items-center flex-wrap"
        >
          <div>
            <h1 class="h3 mb-1">
              <i class="bi bi-file-earmark-text-fill me-2"></i> Recibos Gerados
            </h1>
            <p class="mb-0 opacity-75">Prontos para impressão</p>
          </div>
          <div>
            <a th:href="@{/properties}" class="btn btn-outline-light"
              ><i class="bi bi-arrow-left"></i> Voltar</a
            >
            <button onclick="window.print();" class="btn btn-light">
              <i class="bi bi-printer"></i> Imprimir Todos
            </button>
          </div>
        </div>
      </div>

      <div id="print-area">
        <div th:if="${#lists.isEmpty(receipts)}" class="no-print">
          <p class="alert alert-warning">Nenhum recibo foi gerado.</p>
        </div>

        <div class="printable-page" th:each="receipt : ${receipts}">
          <!-- início da sessão de recibo de locação -->

          <div th:if="${receipt.propertyType != T(imoveis.aluguel.enums.PropertyTypeEnum).CONDOMINIO}">
            <!-- início do primeiro recibo de locação -->

            <div class="receipt-copy top-copy">
              <div>
                <div
                  class="receipt-header d-flex justify-content-between align-items-center mb-4"
                >
                  <h1 class="mb-1">Recibo</h1>
                  <div class="copy-indicator">LOCAÇÃO</div>
                </div>
                <div class="receipt-body">
                  <p>
                    Recebi, de
                    <strong><th:block th:text="${receipt.tenant}" /></strong>, a
                    importância de
                    <strong th:text="${receipt.value}"></strong>
                    referente ao aluguel do(a)
                    <th:block th:text="${#strings.toLowerCase(receipt.propertyType)}" /> nº
                    <strong th:text="${receipt.propertyNumber}"></strong>.&nbsp;
                    <span th:text="${receipt.observation}"></span>. # . # . # . # . # . # . # . # . # . # . # . # . # . # . #
                  </p>
                </div>
              </div>
              <div>
                <p
                  class="text-center mb-0"
                  th:text="${receipt.locale + ', ' + receipt.day + ' de ' + receipt.month + ' de ' + receipt.year + '.'}"
                ></p>
                <div class="signature-line">
                  _______________________________________________<br />
                  <strong th:text="${receipt.landlord}"></strong><br />
                  <span>(Locador/Procurador)</span>
                </div>
                <div
                  class="tenant-contact-info"
                  th:if="${receipt.tenantContact != null and not #strings.isEmpty(receipt.tenantContact)}"
                >
                  <span th:text="${receipt.tenantContact}"></span>
                </div>
              </div>
            </div>

            <!-- fim do primeiro recibo  de locação -->

            <!-- início do segundo recibo de locação -->

            <div class="receipt-copy">
              <div>
                <div
                  class="receipt-header d-flex justify-content-between align-items-center mb-4"
                >
                  <h1 class="mb-1">Recibo</h1>
                  <div class="copy-indicator">LOCAÇÃO</div>
                </div>
                <div class="receipt-body">
                  <p>
                    Recebi, de
                    <strong><th:block th:text="${receipt.tenant}" /></strong>, a
                    importância de
                    <strong th:text="${receipt.value}"></strong>

                    referente ao aluguel do(a)
                    <th:block th:text="${#strings.toLowerCase(receipt.propertyType)}" /> nº
                    <strong th:text="${receipt.propertyNumber}"></strong>.&nbsp;
                    <span th:text="${receipt.observation}"></span>. # . # . # . # . # . # . # . # . # . # . # . # . # . # . #
                  </p>
                </div>
              </div>
              <div>
                <p
                  class="text-center mb-0"
                  th:text="${receipt.locale + ', ' + receipt.day + ' de ' + receipt.month + ' de ' + receipt.year + '.'}"
                ></p>

                <div class="signature-line">
                  _______________________________________________<br />
                  <strong th:text="${receipt.landlord}"></strong><br />
                  <span>(Locador/Procurador)</span>
                </div>

                <div
                  class="tenant-contact-info"
                  th:if="${receipt.tenantContact != null and not #strings.isEmpty(receipt.tenantContact)}"
                >
                  <span th:text="${receipt.tenantContact}"></span>
                </div>
              </div>
            </div>

            <!-- fim do segundo recibo de locação-->
          </div>

          <!-- fim da sessão de recibo de locação -->

          <!-- início da sessão de recibo de condomínio -->

          <div th:if="${receipt.propertyType == T(imoveis.aluguel.enums.PropertyTypeEnum).CONDOMINIO}">
            <!-- início do primeiro recibo de condomínio -->

            <div class="receipt-copy top-copy">
              <div>
                <div
                  class="receipt-header d-flex justify-content-between align-items-center mb-4"
                >
                  <h1 class="mb-1">Recibo</h1>
                  <div class="copy-indicator">CONDOMÍNIO</div>
                </div>
                <div class="receipt-body">
                  <p>
                    Recebi, de
                    <strong><th:block th:text="${receipt.tenant}" /></strong>, a
                    importância de
                    <strong th:text="${receipt.value}"></strong>

                    referente ao pagamento do
                    <th:block th:text="${#strings.toLowerCase(receipt.propertyType)}" /> do mês de
                    <strong
                      th:text="${#strings.toLowerCase(receipt.month)}"
                    ></strong>
                    de
                    <strong th:text="${receipt.year}"></strong>, correspondente a 
                    <strong th:text="${receipt.observation}"></strong>, no
                    Edifício Caliman. # . # . # . # . # . # . # . # . # . # . # . # . # . #
                  </p>
                </div>
              </div>
              <div>
                <p
                  class="text-center mb-0"
                  th:text="${receipt.locale + ', ' + receipt.day + ' de ' + receipt.nextMonth + ' de ' + (receipt.month == 'Dezembro' ? receipt.nextYear : receipt.year) + '.'}"
                ></p>
                <div class="signature-line">
                  _______________________________________________<br />
                  <strong th:text="${receipt.landlord}"></strong><br />
                  <span>(ou procurador)</span>
                </div>
                <div
                  class="tenant-contact-info"
                  th:if="${receipt.tenantContact != null and not #strings.isEmpty(receipt.tenantContact)}"
                >
                  <span th:text="${receipt.tenantContact}"></span>
                </div>
              </div>
            </div>

            <!-- fim do primeiro recibo  de condomínio -->

            <!-- início do segundo recibo de condomínio -->

            <div class="receipt-copy">
              <div>
                <div
                  class="receipt-header d-flex justify-content-between align-items-center mb-4"
                >
                  <h1 class="mb-1">Recibo</h1>
                  <div class="copy-indicator">CONDOMÍNIO</div>
                </div>
                <div class="receipt-body">
                  <p>
                    Recebi, de
                    <strong><th:block th:text="${receipt.tenant}" /></strong>, a
                    importância de
                    <strong th:text="${receipt.value}"></strong>

                    referente ao pagamento do
                    <th:block th:text="${#strings.toLowerCase(receipt.propertyType)}" /> do mês de
                    <strong
                      th:text="${#strings.toLowerCase(receipt.month)}"
                    ></strong>
                    de
                    <strong th:text="${receipt.year}"></strong>, correspondente a 
                    <strong th:text="${receipt.observation}"></strong>, no
                    Edifício Caliman. # . # . # . # . # . # . # . # . # . # . # . # . # . #
                  </p>
                </div>
              </div>
              <div>
                <p
                  class="text-center mb-0"
                  th:text="${receipt.locale + ', ' + receipt.day + ' de ' + receipt.nextMonth + ' de ' + (receipt.month == 'Dezembro' ? receipt.nextYear : receipt.year) + '.'}"
                ></p>
                <div class="signature-line">
                  _______________________________________________<br />
                  <strong th:text="${receipt.landlord}"></strong><br />
                  <span>(ou procurador)</span>
                </div>
                <div
                  class="tenant-contact-info"
                  th:if="${receipt.tenantContact != null and not #strings.isEmpty(receipt.tenantContact)}"
                >
                  <span th:text="${receipt.tenantContact}"></span>
                </div>
              </div>
            </div>
            <!-- fim do segundo recibo de condomínio -->
          </div>

          <!-- fim da sessão de recibo de condomínio -->
        </div>
      </div>
    </section>
  </body>
</html>
